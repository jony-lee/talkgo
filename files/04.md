## 《[04 | 基础篇：经常说的 CPU 上下文切换是什么意思？（下）](https://time.geekbang.org/column/article/70077))》

### 关键概念
1. 自愿上下文切换:进程无法获取所需资源导致上下文切换，比如I/O或内存资源不足.
2. 非自愿上下文切换:进程由于时间片到期,被系统强制调度发生上下文切换.
3. 重调度中断,它表示唤醒空闲状态的CPU来调度新的任务运行,是多处理器系统中调度器用来分散任务到不同CPU的机制.

### 应用实战

利用vmstat查看总的系统上下文切换情况
```
vmstat 1 1
```
利用pidstat查看特定进程上下文切换情况
-t参数提供进程内部多线程的切换情况,这部分切换次数不会在进程切换中体现
```
pidstat -wt 5
```
利用sysbench模拟多线程调度情况
```
sysbench --threads=10 --max-time=300 threads run
```
查看调度的中断情况
```
watch -d cat /proc/interrupts
```

### 问题延伸

### 工具使用

1. vmstat 1
2. pidstat -w -t 
3. sysbench:多线程基准测试工具.
4. /proc/interrupts 提供只读的中断使用情况.

### 简单小结
总而言之,上下文切换以及系统中断的时间相当于操作系统在划水的时间,我们要通过以上手段找出来系统在什么时候划水不干正事,并期望减小这些划水的时间,让CPU尽可能多的去干正事.
